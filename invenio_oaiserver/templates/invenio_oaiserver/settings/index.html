{# -*- coding: utf-8 -*-
#
# This file is part of Invenio.
# Copyright (C) 2016 CERN.
#
# Invenio is free software; you can redistribute it
# and/or modify it under the terms of the GNU General Public License as
# published by the Free Software Foundation; either version 2 of the
# License, or (at your option) any later version.
#
# Invenio is distributed in the hope that it will be
# useful, but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with Invenio; if not, write to the
# Free Software Foundation, Inc., 59 Temple Place, Suite 330, Boston,
# MA 02111-1307, USA.
#
# In applying this license, CERN does not
# waive the privileges and immunities granted to it by virtue of its status
# as an Intergovernmental Organization or submit itself to any jurisdiction.
#}

{%- extends 'invenio_theme/page.html' -%}

{% macro render_row(set, loop=None, indent=0) -%}
    <tr>
        <td>
            {% if loop %}
                {{ loop.index }}
            {% endif %}
        </td>
        <td>{{ indent*"-" }}<a href="{{ url_for(".edit_set", spec=set.spec) }}">{{ set.spec }}</td>
        <td>{{ set.name }}</td>
        <td>{{ set.description }}</td>
        <td>{{ set.search_pattern }}</td>
        <td><a class="btn btn-xs btn-danger" href="{{ url_for(".delete_set", spec=set.spec) }}">Delete</a></td>
    </tr>
    {% if set.oaiset %}
        {% for subset in set.oaiset %}
            {{ render_row(subset, indent=indent+1) }}
        {% endfor %}
    {% endif %}
{%- endmacro %}

{% block page_body%}
<div class="container">
    <h1>OAI-PMH</h1>
    <h2>List of sets</h2>
    <a class="btn btn-default" href="{{ url_for(".new_set")}}">New set</a>
    <table class='table'>
        <thead>
            <tr>
                <th></th>
                <th>Spec</th>
                <th>Name</th>
                <th>Description</th>
                <th>Query</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            {% for set in sets %}
                {{ render_row(set, loop) }}
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
